<html>
    <head>
        <style>
            @import url("https://webglfundamentals.org/webgl/resources/webgl-tutorials.css");
            body {
            margin: 0;
            }
            canvas {
            width: 100vw;
            height: 100vh;
            display: block;
            }
        </style>
        <script type="text/javascript" src="../scripts/gui-utils.js"></script>
        <script type="text/javascript" src="../scripts/webgl-lessons-ui.js"></script>
        <script type="text/javascript" src="../scripts/my-objects.js"></script>
        <script type="text/javascript" src="../scripts/my-webgl-lib.js"></script>
        <script type="text/javascript" src="../scripts/webgl-utils.js"></script>
        <script type="text/javascript" src="../scripts/m4.js"></script>
        <script type="text/javascript" src="../scripts/car.js"></script>
    </head>
    <body>
        <canvas id="canvas"></canvas>
        <div id="uiContainer">
          <div id="ui">
            <div id="fieldOfView"></div>
            <div id="x"></div>
            <div id="y"></div>
            <div id="z"></div>
            <div id="angleX"></div>
            <div id="angleY"></div>
            <div id="angleZ"></div>
            <div id="cameraX"></div>
            <div id="cameraY"></div>
            <div id="cameraZ"></div>
            <div id="cameraAngleX"></div>
            <div id="cameraAngleY"></div>
            <div id="cameraAngleZ"></div>
          </div>
        </div>
        <script  id="vertex-shader-2d" type="x-shader/x-vertex">
            attribute vec4 a_position;
            attribute vec3 a_normal;

            uniform vec3 u_lightWorldPosition;
            uniform mat4 u_world;
            uniform mat4 u_worldViewProjection;
            uniform mat4 u_worldInverseTranspose;
            
            varying vec3 v_normal;
            varying vec3 v_surfaceToLight;

            void main() {
                gl_Position = u_worldViewProjection * a_position;
                v_normal = mat3(u_worldInverseTranspose) * a_normal;
                vec3 surfaceWorldPosition = (u_world * a_position).xyz;
                v_surfaceToLight = u_lightWorldPosition - surfaceWorldPosition;
            }
        </script>
        <script  id="fragment-shader-2d" type="x-shader/x-fragment">
            precision mediump float;
            uniform vec4 u_color;
            varying vec3 v_normal;
            varying vec3 v_surfaceToLight;
            
            void main() {
                vec3 normal = normalize(v_normal);
                vec3 surfaceToLightDirection = normalize(v_surfaceToLight);
                float light = dot(normal, surfaceToLightDirection);
                gl_FragColor = u_color;
                gl_FragColor.rgb *= light;
            }
        </script>
        <script type="text/javascript" src="./game.js"></script>
        <script>
            var key=[false,false,false,false];
            const keys = {
                W: 0, W_CODE: 87,
                A: 1, A_CODE: 65,
                S: 2, S_CODE: 83,
                D: 3, D_CODE: 68,
            }
            window.addEventListener('keydown', doKeyDown, true);
            window.addEventListener('keyup', doKeyUp, true);
            function doKeyDown(e){
                switch(e.keyCode){
                    case keys.W_CODE:
                        key[keys.W]=true;
                        break;
                    case keys.A_CODE:
                        key[keys.A]=true;
                        break;
                    case keys.S_CODE:
                        key[keys.S]=true;
                        break;
                    case keys.D_CODE:
                        key[keys.D]=true;
                        break;
                }
            }
            function doKeyUp(e){
                switch(e.keyCode){
                    case keys.W_CODE:
                        key[keys.W]=false;
                        break;
                    case keys.A_CODE:
                        key[keys.A]=false;
                        break;
                    case keys.S_CODE:
                        key[keys.S]=false;
                        break;
                    case keys.D_CODE:
                        key[keys.D]=false;
                        break;
                }
            }
        </script>

</body>
</html>